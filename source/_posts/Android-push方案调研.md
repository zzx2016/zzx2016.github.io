---
title: Android push方案调研
date: 2016-03-25 10:48:12
tags:
---

### push调研

Android push通道调研文档，输出本文档是为了选择合适的push通道。

消息透传：server push一条消息到app而用户无感知。

### 第三方push通道

目前市面上第三方的push通道还是很多的，较早的JPush、个推，后来小米push、腾讯信鸽、百度推送、华为推送、友盟推送。官方统计的到达率都是99%+，算法是 *送达率 = 送达数 / 计划推送 × 100%*，计划推送是指目标推送的设备数，已去除了错误或无效的设备，所以到达率算出来很高。而开发者反馈的到达率基本在40%~60%之间。

<!--more-->

### 第三方push比较

#### JPush（极光）

支持透传

##### 特点

1. 多种推送方式
 - 通知：推送文本内容直接展示在用户的通知栏中。
 - 自定义消息：推送自定义的消息内容透传给应用处理。
 - 富媒体：推送预先编辑好的图文并茂的HTML页面内容。
2. 灵活的推送目标
 - 广播推送：向所有的注册用户发送一条广播消息。
 - 标签推送：根据属性对用户设置标签分组，向群组用户发送。
 - 别名推送：客户端绑定用户别名，向具体的单个用户推送。
3. 用户分群
 - 根据JPush提供的多条件组合进行用户群组划分，实时筛选实时推送。

##### 评价

在某些网络运营商下,会注册失败；容易出现提交tag和alias延迟，推送到达率还可以，就普遍都比较慢，但后来因为量实在太高，即使是企业合作，费用还是高得有点难接受；比百度和个推到达率要高很多

##### 案例

高德地图、圆通快递、百姓网

---

#### 个推

支持透传

##### 特点
1. 个推1.0-实时推送
 - 消息实时到达，提高用户活跃度
 - 多个App合并通道，省电省流量
 - 应用进程相互看护，活跃有保障
 - 精确数据报表，数据实时统计反馈
2. 个推2.0-智能推送
 - 智能标签，建立精准用户画像
 - 避免盲目推送，实现精细化运营
 - 分组对比测试，优化推送决策
 - 强大的数据联盟，清晰的行业报告
3. 个推3.0-应景推送
 - 精准捕捉场景，合适地点触发消息
 - 进入、停留、离开，情景化推送
 - 性别、年龄、爱好，智能标签分类
 - 学校、商场、火车站，地理围栏调用

##### 评价

创业公司个推用了两年，现在换做信鸽，慢慢尝试中，个推的问题主要有消息被缓存后不能顺序送达，信号不好网络切换频繁以及一些奇葩网络环境，如电信移动需加代理的情形是无可送达的，服务被干掉时有发生且在诸如华为这样的机型上是没法自启，后面信鸽也出现了，可能是业界难题，可对于带点IM性质的app很致命；延迟太大，普通情况下都有几十分钟的延迟。

##### 案例

新浪微博、墨迹天气、PPTV、唱吧、招商银行、美图秀秀、去哪儿

---

#### 小米push

支持透传，在一些拥有应用启动管理功能的Android系统上（如MIUI），透传的实现需要应用在后台处于启动状态

##### 特点
1. 使用简单灵活
 - 集成仅需半天，不用写代码即可直接推送消息，也可通过服务端API与业务深度结合。
既可根据用户不同特征给用户打标签再针对标签进行推送，也可直接指定用户做精准推送。
2. 服务稳定安全
 - 高吞吐：每分钟千万级消息推送；高稳定：亿级同时在线；高到达率：99.8%的消息可以300毫秒内到达。
 - 提供数据统计功能，可以在线查看推送的实时数据和历史数据，同时提供数据API方便开发者与自身的统计系统结合。
3. Android全平台支持
 - 小米推送服务支持所有Android平台，在MIUI上属于系统服务框架，共享系统级长连接。

##### 限制

目前针对首批合作开发者,小米推送服务没有设置任何推送频率的使用限制,之后出于防止恶意应用攻击等考虑,可能会增加对推送消息的频率、对单一用户可以接收的数量等做一些限制,但不会影响开发者的正常使用。而且所提供的推送服务完全免费。

##### 评价

大众点评13年的时候用过小米推送，到达率统计有60%左右，属于小米推送的早期用户吧，据说踩了不少坑，后面自己去做了推送。

##### 案例

58同城、淘宝、爱奇艺、百度视频、暴风影音、携程、美丽说、蘑菇街、今日头条

---

#### 腾讯信鸽

支持透传

##### 特点

1. 多种推送方式 灵活方便
 - 通知：推送文本内容直接展示在用户的通知栏中
 - 消息命令：推送自定义的消息内容透传给应用处理
2. 推送目标分类 精准营销
 - 标签推送：根据属性特性对用户设置标签分组，向群组用户发送
 - 别名推送：客户端绑定用户别名，向具体的单个用户推送
 - 全量推送：向所有的注册用户发送一条广播消息
 - 标签推送新增高级标签 —— 潜在流失用户、潜在付费用户，推送让你快人一步
3. 推送数据统计 效果跟踪
 - 推送数据：推送量、抵达量数据统计
 - 效果跟踪：单个推送通知目标用户行为30天持续跟踪

##### 评价

不是很稳定，有时推送较慢，不及时；有很多问题，不稳定是主要的，另外就是到达率不高，好的情况下60%，坏的情况下40%也不到；比较小众，腾讯自己的产品都不用


##### 案例

美丽说、掌上英雄联盟

---

#### 百度推送

支持透传

##### 特点

- **安全稳定：** 消息下发速度高达每秒数十万次，保证稳定秒级到达

- **智能推送：** 依托百度大数据，准确定位目标客户，实现精准推送

- **统计分析：** 强大的数据统计报表支撑，可以智能化分析推送

- **省电省流量：** 百度云推送提供免费服务且设备能耗更低，消息推送更快，连接更稳定

- **个性化设置：** 定时推送，离线设置，自定义标签，支持富媒体，多种个性化功能

- **管理控制台：** 可视化页面帮您通过控制台针对特定用户群快速完成推送

##### 评价

到达率差不多60%，但太多坑，各种不兼容造成崩溃、Application循环重启、手机发烫等问题；百度推送过来的通知消息如果隔了较长时间才去点击通知的话，打开对应的应用挺久才反应过来，不知道是不是手机卡的问题，用的是三星S5。小米推送的不会，隔了较长时间点击通知基本上马上打开。

##### 案例

手机百度、百度地图、爱奇艺、聚美优品

---

#### 华为推送

支持透传，在华为上属于系统服务框架，共享系统级长连接。

##### 特点

- **推送透传消息：** 以透传方式将自定义的内容发送给应用。开发者的应用自主解析自定义的内容，并触发相关动作。利用此功能开者可实现IP呼叫、好友邀请等等功能，完全自由发挥。

- **推送通知栏消息：** 消息推送到手机的系统通知栏展现。

- **推送富媒体消息：** 消息推送可自由编排的富媒体内容到手机展现，支持表格、图片、音频、连接地址等，类似Html5页面效果。

- **按地理位置触发消息(LBS消息)：** 在地图上划定一块区域，消息推送到进入该区域的用户。

- **在线编辑内容和推送：** 可以在开发者联盟Portal上编辑消息内容，并选择用户群推送

- **支持自定义标签：** 开发者可以对用户打上私有签标，细分用户群，推送时可以选择推给特定标签的用户。

- **统计报表：** 提供消息推送情况和用户发展情况的统计报表。

##### 案例

未列出

---

#### 友盟推送

支持透传

##### 特点

1. 多维度用户分群
 - 帮助开发者将不同用户按照不同特征分群，从而为不同分群的用户推送最合适的内容，大幅度提升消息打开率和用户满意度。
2. 自由选择发送内容
 - 开发者可以选择发送通知或者自定义消息，自主决定发送内容是否被展示给用户。
 - 开发者可以自由配置用户查看消息后的操作，支持打开 APP指定页面、打开指定网页以及其它自定义行为。
3. 灵活接入
 - 支持开发者通过Web 端操作或者 API接入，满足不同场景下的推送需求。
 - Web端后台操作：开发者可以在 Web后台人工操作，按多个维度筛选用户并群发消息。
 - API接入方式：开发者可以通过 API对接友盟服务器，自动化的推送消息。

##### 案例

斗鱼、暴风影音、墨迹天气

#### gcm推送

gcm要求设备运行在Android系统2.2或更高版本并且安装了Google play商店应用，但是并不限制你的应用必须部署在Google play商店。如果想要使用gcm 新的API就需要设备运行在Android系统2.3或更高版本，在一个现有连接Google服务的设备上，对于3.0之前的设备，就要求在Android设备上设置Google账号，4.0.4或者更高版本则不需要设置Google账号。支持透传。

##### gcm的一些限制

1. 在国内，首先就是Google被墙，无法连接到Google服务器，需要你走VPN或者其它方式可以连接到Google服务器。

2. Android客户端，要求安装了Google核心服务Google Play服务，而有些厂商会去掉Google Play服务

3. 由于国内2G和移动3G的NAT超时时间都小于GCM心跳时间(28分钟)，TCP长连接必然无法保活，每次都要等28分钟心跳失败重连后才能收到Push。

4. 某些运营商可能限制了5228端口，移动3G/2G下，发现几乎无法连接上GCM服务器，也就无法获得GCM通知，某些放后台10分钟后，经常很长时间都收不到Push消息。

### 集成方案

先看一下Android相关设备占比，如下图

![Android相关设备占比](http://7q5ctm.com1.z0.glb.clouddn.com/20160324170743.png)

其他：19.84%、三星：15.06%、华为：11.07%、小米：7.90%、红米：7.63%、Vivo：7.61%、Oppo：6.65%。

为了提高到达率，最好采用集成多种push通道，针对小米手机优先使用小米push，华为手机使用华为push，其他手机选择个推或者其他，从开发者认知度来看，认知度由高到低排列如下：小米推送>华为=个推>其他(腾讯信鸽、JPush、百度推送、友盟推送)，华为推送暂无数据，其中百度，腾讯的推送口碑最差，自己都不用。小米和华为的push由于是保持系统级长连接，所以到达率很高。从官方文档来看，只有个推支持多个App合并通道，也就是说其他使用个推的app会保持push通道的活性，因为新浪微博使用了个推，所以在很大程度上保证了个推通道的畅通。
